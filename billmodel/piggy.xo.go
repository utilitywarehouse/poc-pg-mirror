// Package billmodel contains the types for schema 'equinox'.
package billmodel

// GENERATED BY XO. DO NOT EDIT.

import (
	"database/sql"

	"github.com/lib/pq"
)

// Piggy represents a row from 'equinox.piggies'.
type Piggy struct {
	Piggybondid   sql.NullInt64   `json:"piggybondid"`   // piggybondid
	Pbtype        sql.NullString  `json:"pbtype"`        // pbtype
	Pbvalue       sql.NullFloat64 `json:"pbvalue"`       // pbvalue
	Pbdestination sql.NullString  `json:"pbdestination"` // pbdestination
	Pbexecid      sql.NullString  `json:"pbexecid"`      // pbexecid
	Pbclaimperiod sql.NullString  `json:"pbclaimperiod"` // pbclaimperiod
	Pbentered     pq.NullTime     `json:"pbentered"`     // pbentered
	Pbenteredby   sql.NullString  `json:"pbenteredby"`   // pbenteredby
	Pbsparec1     sql.NullString  `json:"pbsparec1"`     // pbsparec1
	Pbsparec2     sql.NullString  `json:"pbsparec2"`     // pbsparec2
	Pbsparen1     sql.NullFloat64 `json:"pbsparen1"`     // pbsparen1
	Pbsparen2     sql.NullFloat64 `json:"pbsparen2"`     // pbsparen2
	Pbspared1     pq.NullTime     `json:"pbspared1"`     // pbspared1
	EquinoxLrn    int64           `json:"equinox_lrn"`   // equinox_lrn
	EquinoxSec    sql.NullInt64   `json:"equinox_sec"`   // equinox_sec
}

func AllPiggy(db XODB, callback func(x Piggy) bool) error {

	// sql query
	const sqlstr = `SELECT ` +
		`piggybondid, pbtype, pbvalue, pbdestination, pbexecid, pbclaimperiod, pbentered, pbenteredby, pbsparec1, pbsparec2, pbsparen1, pbsparen2, pbspared1, equinox_lrn, equinox_sec ` +
		`FROM equinox.piggies `

	q, err := db.Query(sqlstr)

	if err != nil {
		return err
	}
	defer q.Close()

	// load results
	for q.Next() {
		p := Piggy{}

		// scan
		err = q.Scan(&p.Piggybondid, &p.Pbtype, &p.Pbvalue, &p.Pbdestination, &p.Pbexecid, &p.Pbclaimperiod, &p.Pbentered, &p.Pbenteredby, &p.Pbsparec1, &p.Pbsparec2, &p.Pbsparen1, &p.Pbsparen2, &p.Pbspared1, &p.EquinoxLrn, &p.EquinoxSec)
		if err != nil {
			return err
		}
		if !callback(p) {
			return nil
		}
	}

	return nil
}

// PiggyByEquinoxLrn retrieves a row from 'equinox.piggies' as a Piggy.
//
// Generated from index 'piggies_pkey'.
func PiggyByEquinoxLrn(db XODB, equinoxLrn int64) (*Piggy, error) {
	var err error

	// sql query
	const sqlstr = `SELECT ` +
		`piggybondid, pbtype, pbvalue, pbdestination, pbexecid, pbclaimperiod, pbentered, pbenteredby, pbsparec1, pbsparec2, pbsparen1, pbsparen2, pbspared1, equinox_lrn, equinox_sec ` +
		`FROM equinox.piggies ` +
		`WHERE equinox_lrn = $1`

	// run query
	XOLog(sqlstr, equinoxLrn)
	p := Piggy{}

	err = db.QueryRow(sqlstr, equinoxLrn).Scan(&p.Piggybondid, &p.Pbtype, &p.Pbvalue, &p.Pbdestination, &p.Pbexecid, &p.Pbclaimperiod, &p.Pbentered, &p.Pbenteredby, &p.Pbsparec1, &p.Pbsparec2, &p.Pbsparen1, &p.Pbsparen2, &p.Pbspared1, &p.EquinoxLrn, &p.EquinoxSec)
	if err != nil {
		return nil, err
	}

	return &p, nil
}
